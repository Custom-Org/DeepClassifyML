<html>
  <head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="css/custom.css">
    <link class="jsbin" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" />
    <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.0/jquery-ui.min.js"></script>
    <meta charset=utf-8 />
    <script src="js/main_system.js"></script>
    <script type="text/javascript">
      var img=document.getElementById("img");
      img.style.display='none';
      var table=document.getElementById("table");
      table.style.display='none';
      var loading=document.getElementById("loading");
      loading.style.display='none';
      var btn=document.getElementById("btn_search");
      btn.addEventListener("click", classify_system);

    function readURL(input) {
      if (input.files && input.files[0]) {
          var reader = new FileReader();
          reader.onload = function (e) {
              var img = document.getElementById("img");
              img.style.display='block';
              img.src=e.target.result;

              var BASE64_MARKER = ';base64,';
              var base64Index = img.src.indexOf(BASE64_MARKER) + BASE64_MARKER.length;
              var base64 = img.src.substring(base64Index);
              var raw = window.atob(base64);
              var rawLength = raw.length;
              var array = new Uint8Array(new ArrayBuffer(rawLength));

              for(i = 0; i < rawLength; i++) {
                array[i] = raw.charCodeAt(i);
              }

              console.log(array)
              table.innerHTML="";
              loading.style.display='block';
              var url="classify_system?imageurl=" + array;
              $.get(url, function(data, status){
                table.style.display='block';
                loading.style.display='none';
                for(var i=data.results.length-1;i>=0;i--){
                  var row = table.insertRow(0);
                  var cell1 = row.insertCell(0);
                  var cell2 = row.insertCell(1);
                  cell1.innerHTML = data.results[i].class_name;
                  cell2.innerHTML = data.results[i].score;
                }
                var row = table.insertRow(0);
                var cell1 = row.insertCell(0);
                var cell2 = row.insertCell(1);
                cell1.innerHTML = "<b>Class Name</b>";
                cell2.innerHTML = "<b>Score</b>";
              });

          };

          reader.readAsDataURL(input.files[0]);
      }
  }    
</script>
    <title>Image Classifcation</title>
  </head>
  <body id="main">
    <div class="container">
      <div class="row">
        <br><br>
        <div class="col-lg-2"></div>
        <div class="col-lg-8">
          <h1>Image Classification with InceptionV3</h1>
        </div>
        <div class="col-lg-2"></div>
      </div>
      <input type='file' onchange="readURL(this);" />
      <div class="row">
        <br><br>
        <div class="col-lg-2"></div>
        <div class="col-lg-8">
        <div class="container">
      <hr/>
    </div>
          <div class="input-group">
            <span class="input-group-btn">
              <button id="btn_search" class="btn btn-primary" type="button">Go!</button>
            </span>
          </div>
          <br><br>
          <div class="col-lg-6">
            <img id="img" src="#" class="img-responsive" alt="Your Image">
          </div>
          <div class="col-lg-6">
            <div id="loading"> Recognizing . . </div>
            <table id="table" class="table table-striped">
            </table>
          </div>
        </div>
        <div class="col-lg-2"></div>
      </div>
    </div>
    <footer><center> Made By - <b>Akshay</b> </center></footer>
    <script src="js/main_system.js"></script>
  </body>
</html>
